From a3281940fb6456518ea7f31561e7a1e36431d33a Mon Sep 17 00:00:00 2001
From: niyin <yin.ni@gl-inet.com>
Date: Thu, 20 Oct 2022 19:07:12 -0700
Subject: [PATCH] The static address is disconnected and cannot be connected
 again.

---
 .../base-files/etc/init.d/gpy211-link-poll    | 20 +++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/target/linux/mediatek/base-files/etc/init.d/gpy211-link-poll b/target/linux/mediatek/base-files/etc/init.d/gpy211-link-poll
index 9176982646..55589c2f58 100755
--- a/target/linux/mediatek/base-files/etc/init.d/gpy211-link-poll
+++ b/target/linux/mediatek/base-files/etc/init.d/gpy211-link-poll
@@ -14,14 +14,18 @@ gpy211_link_poll() {
 
 		echo "$bit10" > /var/run/gpy211_state
 
-		[ $bit10 -eq $old_state ] || {
-			old_state=$bit10
-			if [ $bit10 = "0" ];then
-				ifconfig eth0 down
-			else
-				ifconfig eth0 up
-			fi
-		}
+		proto=$(uci get network.wan.proto | grep "static")
+
+		if [ -z "$proto" ];then
+			[ $bit10 -eq $old_state ] || {
+				old_state=$bit10
+				if [ $bit10 = "0" ];then
+					ifconfig eth0 down
+				else
+					ifconfig eth0 up
+				fi
+			}
+		fi
 
 		sleep 1
 	done
-- 
2.25.1

